---
- name: create db.mysql.shared src directory
  file: path={{ src_dir }}/db.mysql.shared/ state=directory owner=root group=root

- name: copy MySQL-client rpm
  copy: src={{ local_mysql_rpm_dir }}/{{ mysql_rpm_string % 'client' }}
        dest={{ src_dir }}/db.mysql.shared/
        owner=root group=root

- name: install MySQL-client and MySQL-python
  yum: name={{ item }}
  with_items:
    - MySQL-python
    - "{{ src_dir }}/db.mysql.shared/{{ mysql_rpm_string % 'client' }}"

- include: server.yml
  when: "(client_only is not defined or not client_only) and (backup_only is not defined or not backup_only)"

- include: backup.yml
  when: "(client_only is not defined or not client_only) and ((backup_only is defined and backup_only) or (backup is defined and backup))"
